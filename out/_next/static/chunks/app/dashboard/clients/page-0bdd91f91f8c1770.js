(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{1982:function(e,s,a){Promise.resolve().then(a.bind(a,1455))},1455:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return z}});var i=a(7437),r=a(2265),t=a(5750),l=a(1827),c=a(1295),n=a(8203),d=a(6141),o=a(2176),m=a(890),x=a(7918),h=a(8257),u=a(1908),v=a(8094),g=a(6042),f=a(4863),j=a(6763),p=a(6110),N=a(4522),y=a(9311);let b=N.fC,w=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,i.jsx)(N.aV,{ref:s,className:(0,y.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});w.displayName=N.aV.displayName;let _=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,i.jsx)(N.xz,{ref:s,className:(0,y.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});_.displayName=N.xz.displayName;let C=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,i.jsx)(N.VY,{ref:s,className:(0,y.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});C.displayName=N.VY.displayName;var Z=a(3023),k=a(9401),S=a(2621);function z(){let{user:e}=(0,f.a)(),{toast:s}=(0,S.pm)(),[a,N]=(0,r.useState)([]),[y,z]=(0,r.useState)([]),[I,M]=(0,r.useState)(!0),[D,E]=(0,r.useState)(null),[L,O]=(0,r.useState)(null),[P,A]=(0,r.useState)(null),[F,Y]=(0,r.useState)(""),[Q,V]=(0,r.useState)("name"),[R,U]=(0,r.useState)(1),[W,J]=(0,r.useState)(!1),[T,q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!async function(){if(!e){console.log("No user found"),M(!1);return}try{E(null),console.log("Fetching specialist ID for user:",e.id);let{data:s,error:a}=await j.OQ.from("specialists").select("id").eq("auth_user_id",e.id).single();if(a)throw a;s&&(console.log("Found specialist ID:",s.id),O(s.id))}catch(e){console.error("Error fetching specialist ID:",e),E("Failed to fetch specialist data")}finally{M(!1)}}()},[e]);let B=async()=>{if(L)try{M(!0),E(null);let{data:e,error:s}=await j.OQ.rpc("get_specialist_caregivers_with_archive",{p_specialist_id:L,p_sort_field:"last_activity",p_sort_order:"desc",p_limit:50,p_offset:0,p_include_archived:T,p_archived_only:W});if(s)throw s;console.log("Loaded caregivers:",(null==e?void 0:e.length)||0),N(e||[]),z(e||[])}catch(e){console.error("Error loading caregivers:",e),E("Failed to load caregivers")}finally{M(!1)}};(0,r.useEffect)(()=>{B()},[L,W,T]);let G=async e=>{if(!L){console.error("No specialist ID available"),s({variant:"destructive",title:"Error",description:"Unable to perform this action. Please try again later."});return}try{let{error:a}=await j.OQ.rpc("toggle_caregiver_archive",{p_specialist_id:L,p_caregiver_id:e});if(a)throw a;B(),s({title:"Success",description:"Caregiver status updated successfully."})}catch(e){console.error("Error toggling archive status:",e),s({variant:"destructive",title:"Error",description:"Failed to update caregiver status."})}};if((0,r.useEffect)(()=>{let e=[...a];F&&(e=e.filter(e=>e.caregiver_name.toLowerCase().includes(F.toLowerCase())||e.caregiver_email.toLowerCase().includes(F.toLowerCase()))),e.sort((e,s)=>{switch(Q){case"name":return e.caregiver_name.localeCompare(s.caregiver_name);case"recent":return new Date(s.last_activity).getTime()-new Date(e.last_activity).getTime();case"status":return("active"===s.status?1:-1)-("active"===e.status?1:-1);default:return 0}}),z(e)},[a,F,Q]),I)return(0,i.jsxs)("div",{className:"flex-1 p-8",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Clients"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Manage and monitor your client relationships"})]}),(0,i.jsx)(g.W,{})]}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((e,s)=>(0,i.jsxs)(p.Zb,{className:"animate-pulse",children:[(0,i.jsxs)(p.Ol,{className:"space-y-4",children:[(0,i.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"}),(0,i.jsx)("div",{className:"h-3 bg-muted rounded w-1/2"})]}),(0,i.jsx)(p.aY,{children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)("div",{className:"h-3 bg-muted rounded"}),(0,i.jsx)("div",{className:"h-3 bg-muted rounded w-5/6"})]})})]},s))})})]});if(D)return(0,i.jsx)("div",{className:"flex-1 p-8",children:(0,i.jsxs)("div",{className:"rounded-lg border border-destructive bg-destructive/10 p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-destructive",children:"Error Loading Clients"}),(0,i.jsx)("p",{className:"text-sm text-destructive/80 mt-1",children:D})]})});if(0===a.length)return(0,i.jsxs)("div",{className:"flex-1 p-8",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Clients"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Manage and monitor your client relationships"})]}),(0,i.jsx)(g.W,{})]}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"rounded-lg border bg-card p-8",children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,i.jsx)("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:(0,i.jsx)(t.Z,{className:"h-6 w-6 text-primary"})}),(0,i.jsx)("h3",{className:"text-lg font-medium text-foreground",children:"No Clients Yet"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground mt-2 max-w-sm",children:"Get started by inviting your first client to join your practice."}),(0,i.jsx)(g.W,{})]})})})]});let H=y.filter(e=>"active"===e.status),K=y.filter(e=>"active"!==e.status),X=y.filter(e=>e.archived).length;return(0,i.jsxs)("div",{className:"flex-1 p-8",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Clients"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Manage and monitor your client relationships"})]}),(0,i.jsx)(g.W,{})]}),(0,i.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(l.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,i.jsx)(u.I,{placeholder:"Search caregivers...",value:F,onChange:e=>Y(e.target.value),className:"pl-10 w-full transition-all duration-200 ease-in-out"})]}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-6 flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(h.r,{checked:W,onCheckedChange:J,id:"archived-mode",className:"transition-opacity duration-200"}),(0,i.jsx)("label",{htmlFor:"archived-mode",className:"text-sm text-muted-foreground cursor-pointer transition-colors duration-200 hover:text-foreground",children:"Show Archived"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(h.r,{checked:T,onCheckedChange:q,id:"include-archived",className:"transition-opacity duration-200"}),(0,i.jsx)("label",{htmlFor:"include-archived",className:"text-sm text-muted-foreground cursor-pointer transition-colors duration-200 hover:text-foreground",children:"Include Archived in Search"})]})]}),(0,i.jsxs)(v.Ph,{value:Q,onValueChange:V,children:[(0,i.jsx)(v.i4,{className:"w-[180px] transition-all duration-200",children:(0,i.jsx)(v.ki,{placeholder:"Sort by"})}),(0,i.jsxs)(v.Bw,{children:[(0,i.jsx)(v.Ql,{value:"name",children:"Name"}),(0,i.jsx)(v.Ql,{value:"recent",children:"Most Recent"}),(0,i.jsx)(v.Ql,{value:"status",children:"Status"})]})]})]})]}),(0,i.jsxs)(b,{defaultValue:"active",className:"space-y-6",children:[(0,i.jsxs)(w,{children:[(0,i.jsxs)(_,{value:"active",children:["Active Clients (",H.length,")"]}),(0,i.jsxs)(_,{value:"archived",disabled:!W,children:["Archived (",X,")"]}),(0,i.jsxs)(_,{value:"inactive",children:["Inactive (",K.length,")"]})]}),(0,i.jsx)(C,{value:"active",className:"space-y-6",children:(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:H.map(e=>(0,i.jsxs)(p.Zb,{children:[(0,i.jsxs)(p.Ol,{children:[(0,i.jsx)(p.ll,{children:e.caregiver_name}),(0,i.jsxs)(p.SZ,{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.caregiver_email})]})]}),(0,i.jsx)(p.aY,{children:(0,i.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Joined ",(0,x.ZP)(new Date(e.last_activity),"MMM d, yyyy")]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Last active ",(0,x.ZP)(new Date(e.last_activity),"h:mm a")]})]}),(0,i.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,i.jsx)(Z.z,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:()=>G(e.caregiver_id),children:e.archived?"Unarchive":"Archive"}),(0,i.jsxs)(Z.z,{variant:"secondary",size:"sm",className:"flex items-center gap-2",onClick:()=>{L&&A({specialistId:L,caregiverId:e.caregiver_id,caregiverName:e.caregiver_name})},children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),"Chat"]})]})]})})]},e.caregiver_id))})}),(0,i.jsx)(C,{value:"archived",className:"space-y-6",children:(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:y.filter(e=>e.archived).map(e=>(0,i.jsxs)(p.Zb,{children:[(0,i.jsxs)(p.Ol,{children:[(0,i.jsx)(p.ll,{children:e.caregiver_name}),(0,i.jsxs)(p.SZ,{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.caregiver_email})]})]}),(0,i.jsx)(p.aY,{children:(0,i.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Joined ",(0,x.ZP)(new Date(e.last_activity),"MMM d, yyyy")]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Last active ",(0,x.ZP)(new Date(e.last_activity),"h:mm a")]})]}),(0,i.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,i.jsx)(Z.z,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:()=>G(e.caregiver_id),children:"Unarchive"}),(0,i.jsxs)(Z.z,{variant:"secondary",size:"sm",className:"flex items-center gap-2",onClick:()=>{L&&A({specialistId:L,caregiverId:e.caregiver_id,caregiverName:e.caregiver_name})},children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),"Chat"]})]})]})})]},e.caregiver_id))})}),(0,i.jsx)(C,{value:"inactive",className:"space-y-6",children:(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:K.map(e=>(0,i.jsxs)(p.Zb,{children:[(0,i.jsxs)(p.Ol,{children:[(0,i.jsx)(p.ll,{children:e.caregiver_name}),(0,i.jsxs)(p.SZ,{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.caregiver_email})]})]}),(0,i.jsx)(p.aY,{children:(0,i.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Joined ",(0,x.ZP)(new Date(e.last_activity),"MMM d, yyyy")]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d.Z,{className:"h-4 w-4"}),(0,i.jsxs)("span",{children:["Last active ",(0,x.ZP)(new Date(e.last_activity),"h:mm a")]})]}),e.archived&&(0,i.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,i.jsx)(m.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:"Archived"})]}),(0,i.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,i.jsx)(Z.z,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:()=>G(e.caregiver_id),children:e.archived?"Unarchive":"Archive"}),(0,i.jsxs)(Z.z,{variant:"secondary",size:"sm",className:"flex items-center gap-2",onClick:()=>{L&&A({specialistId:L,caregiverId:e.caregiver_id,caregiverName:e.caregiver_name})},children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),"Chat"]})]})]})})]},e.caregiver_id))})}),P&&(0,i.jsx)(k.z,{specialistId:P.specialistId,caregiverId:P.caregiverId,caregiverName:P.caregiverName,onClose:()=>A(null)})]})]})]})}},8257:function(e,s,a){"use strict";a.d(s,{r:function(){return c}});var i=a(7437),r=a(2265),t=a(2376),l=a(9311);let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,i.jsx)(t.fC,{className:(0,l.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:s,children:(0,i.jsx)(t.bU,{className:(0,l.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});c.displayName=t.fC.displayName}},function(e){e.O(0,[566,237,436,233,0,747,506,338,375,102,42,971,864,744],function(){return e(e.s=1982)}),_N_E=e.O()}]);